<!DOCTYPE>
<html>

<head>
    <meta charset="utf-8">
    <title>js 测试测试</title>
    <link rel="stylesheet" type="text/css" href="../../res/css/myStyle1.css">
    <link rel="stylesheet" href="../../res/css/common.css">
    <script charset="utf-8" type="text/javascript"  src="../../lib/md5.main.js" ></script>
    <style>

    </style>
</head>

<body>
    <h2 class="tac mClear w100 topAlign ptb10 bg666">这是标题</h2>
    
    <button onclick="replace()">正则替换</button>
    <button onclick="int()">int 格式化</button>
    <p id="testStr">测试字符串</p>
    <p id="testStrRep">测试字符串</p>
    <button onclick="testWxHeadUrl()">检测是否是微信头像</button>    
    <button onclick="testWxReplace()">替换</button>  

    <button onclick="test()">测试</button>  


    
    <button onclick="check()">test</button>
    <button onclick="encode()">encodeURIComponent</button>    
    <button onclick="decode()">decodeURIComponent</button>
    
    <div class="tac mt10">
        <a class="btn1 mr30" href="javascript:void()" onclick="goLast()">上一篇 填入内容</a>
        <a class="btn1 ml30" href="javascript:void()" onclick="goNext()">下一篇 填入内容</a>
    </div>
    <img src="http://wx.qlogo.cn/mmopen/MeYAJia759rXrSStqhBpZibwH9juxeREUjghZtG8CibZCyfibgY1NS7AhK4jG58zib1KHcW0LY83Wv7sBGp2Ofs95nyFpCeClm6DB/0" />
</body>

<script>

    function test(){
        // console.log(sumMoney(8.7,0))
        // console.log(sumMoney("17.4",0))
        // console.log(accAdd("17.4",0))
        // console.log(accAdd("8.7",0))
        //231242.44+281898.31+190742.02+197754.05

        // console.log(Subtr(sumMoney("17.4",0) , "0"))

        // getHttpSign()
        // console.log(telCheck("15225137663"))
        checkTel("15225137663")
    }


    function checkTel(number){

        if(!/^((0\d{2,3}-\d{7,8})|(1[3456789]\d{9}))$/.test(number)){
            alert('固定电话有误，请重填');
        return false;
        }
    }


    function encode(){
        console.log(encodeURIComponent('新建“一户一表‘申请’啊啊啊”'))
        console.log(encodeURIComponent("'''''"))
    }

    function decode(){
        console.log(decodeURIComponent(''))
    }

    function goLast(){
        location.href = "填入连接"
    }
    function goNext(){
        location.href = "填入连接"
    }

    function int(){
        console.log(parseInt('-100'))
        console.log( parseInt('-100') < 0)
       
    }

    function check2(){
        let name = 'WaterPriceInfo'
        let test = new RegExp(name)
      console.log(test.exec('http://test.iwaterdata.com/iwaterAppWeb/reactProject/html/waterMeter.html#/WaterPriceInfo?waterCorpId=22'))
    }

    function check(){
        let test = new RegExp(/^imge\//)
        console.log(test.test('imge/imgeadad/imge/jpeg//'))
    }

    function replace(){
      let p = document.getElementById("testStr")
      let repHtml = document.getElementById("testStrRep")
      let str = "一己之力|灭掉中国嘻哈圈，人称|——“平西王”"
      p.innerHTML = str
      console.log(str)
      console.log(str.replace("|","<br/>"))
      repHtml.innerHTML = str.replace(/\|/g,"<br/>&nbsp;&nbsp;&nbsp;&nbsp;")
    }

    function testWxHeadUrl(){
        let wxUrl = "http://wx.qlogo.cn/mmopen/MeYAJia759rXrSStqhBpZibwH9juxeREUjghZtG8CibZCyfibgY1NS7AhK4jG58zib1KHcW0LY83Wv7sBGp2Ofs95nyFpCeClm6DB/0"
        let test = /http:\/\/wx.qlogo.cn/
        console.log(test.exec(wxUrl) != null && test.exec(wxUrl).index == 0)
    }

    function testWxReplace(){
        let wxUrl = "\"http://wx.qlogo.cn/mmopen/MeYAJia759rXrSStqhBpZibwH9juxeREUjghZtG8CibZCyfibgY1NS7AhK4jG58zib1KHcW0LY83Wv7sBGp2Ofs95nyFpCeClm6DB/0\""
        console.log(wxUrl)
        console.log(wxUrl.replace(/"/g,""))
    }

    function Subtr(arg1, arg2) {
        var r1, r2, m, n;
        try {
            r1 = arg1.toString().split(".")[1].length
        } catch (e) {
            r1 = 0
        }
        try {
            r2 = arg2.toString().split(".")[1].length
        } catch (e) {
            r2 = 0
        }
        m = Math.pow(10, Math.max(r1, r2));
        //last modify by deeka
        //动态控制精度长度
        n = (r1 >= r2) ? r1 : r2;
        return ((arg1 * m - arg2 * m) / m).toFixed(2);
    }

    function telCheck(mobile) {
    var myreg = /^(((13[0-9]{1})|(14[0-9]{1})|(19[0-9]{1})|(17[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(18[0-9]{1}))+\d{8})$/;
        if (!myreg.test(mobile)) {
            return false;
        }
    return true;
    }

    /**
    * 计算金额累加
    * @param a
    * @param b
    * @return {number}
    */
    function sumMoney(a, b) {
        console.log(parseFloat(a * 100))
        return (Math.floor((parseFloat(a * 100).toFixed(2))+ parseFloat(b * 100).toFixed(2))/100).toFixed(2)
    }

    /**
 ** 加法函数，用来得到精确的加法结果
 ** 说明：javascript的加法结果会有误差，在两个浮点数相加的时候会比较明显。这个函数返回较为精确的加法结果。
 ** 调用：accAdd(arg1,arg2)
 ** 返回值：arg1加上arg2的精确结果
 **/
function accAdd(arg1, arg2) {
    var r1, r2, m, c;
    try {
        r1 = arg1.toString().split(".")[1].length;
    }
    catch (e) {
        r1 = 0;
    }
    try {
        r2 = arg2.toString().split(".")[1].length;
    }
    catch (e) {
        r2 = 0;
    }
    c = Math.abs(r1 - r2);
    m = Math.pow(10, Math.max(r1, r2));
    if (c > 0) {
        var cm = Math.pow(10, c);
        if (r1 > r2) {
            arg1 = Number(arg1.toString().replace(".", ""));
            arg2 = Number(arg2.toString().replace(".", "")) * cm;
        } else {
            arg1 = Number(arg1.toString().replace(".", "")) * cm;
            arg2 = Number(arg2.toString().replace(".", ""));
        }
    } else {
        arg1 = Number(arg1.toString().replace(".", ""));
        arg2 = Number(arg2.toString().replace(".", ""));
    }
    return (arg1 + arg2) / m;
}
 
//给Number类型增加一个add方法，调用起来更加方便。
Number.prototype.add = function (arg) {
    return accAdd(arg, this);
};

    function getHttpSign(){
        //apiType=APP&appVersion=3.0.14&clientType=android&device=MX5&deviceId=48b4927cdffbc5cb2130aae0c3c33798&latitude=39.997398&longitude=116.419057&mobile=17600299932&nonce=858&platform=baidu&sdkVersion=22&timestamp=1526368693&type=3&waterCorpId=233&key=41dce5b3f435c6129a2d967eb7bb9676
        var data = {"device":"MX5","deviceId":"48b4927cdffbc5cb2130aae0c3c33798","clientType":"android","longitude":116.419057,"mobile":"17600299932","timestamp":1526368693,"platform":"baidu","appVersion":"3.0.14","sdkVersion":22,"latitude":39.997398,"apiType":"APP","waterCorpId":233,"type":"3","nonce":858}
        //"sign":"911D47E460A9CFAA6716AE2FAF06878F"
        var sdic=Object.keys(data).sort();
        var order = ""
        for(ki in sdic){                     
            console.log(sdic[ki]+":"+data[sdic[ki]])
            order = order + sdic[ki] + "=" + data[sdic[ki]] + "&"
        }
        order = order + "key=41dce5b3f435c6129a2d967eb7bb9676"
        console.log(order)
        console.log(md5(order).toUpperCase())
    }

</script>

</html>